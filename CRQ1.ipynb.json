{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.pyplot import figure"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "events = pd.read_json('/Users/MO/Desktop/AMD/AMD-HW2/Dataset/events/events_England.json')\n",
    "players = pd.read_json('/Users/MO/Desktop/AMD/AMD-HW2/Dataset/players.json')\n",
    "teams = pd.read_json('/Users/MO/Desktop/AMD/AMD-HW2/Dataset/teams.json')\n",
    "matches = pd.read_json('/Users/MO/Desktop/AMD/AMD-HW2/Dataset/matches/matches_England.json')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Get indeces of Goals events according following tags: (101'Goal' or 102'Own goal') and 1801'Accurate'\n",
    "tags=[]\n",
    "goals_idx=[]\n",
    "for i in events['tags']: #i is the event raw\n",
    "    tags.append([j.get('id') for j in i]) #Getting tags IDs for every i as a list then append to tags list\n",
    "for i in range(len(tags)): \n",
    "    if (101 in tags[i])or (102 in tags[i]): #To filter tags and get Goal events indeces\n",
    "        goals_idx.append(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "# Save attempt events 1019\n",
      "# other events 1017\n",
      "2499781\n",
      "2499988\n"
     ]
    }
   ],
   "source": [
    "print(\"# Save attempt events\",events.loc[goals_idx].query(\"eventName == 'Save attempt'\").shape[0])\n",
    "print(\"# other events\",events.loc[goals_idx].query(\"eventName != 'Save attempt'\").shape[0])\n",
    "# If every scored goal has 2 events: one form the attack side and the other from the defence side, so the last 2 numbers\n",
    "# has to be equal 1018 (the same number of match results in Matches Dataset) but here there is a problem in 2 matches\n",
    "#as following\n",
    "uni = events.loc[goals_idx].matchId.unique() #Getting the unique matchIds\n",
    "for i in uni: #iterate to find which match has diffrent values attack and defence events\n",
    "    saves=0\n",
    "    others=0\n",
    "    df= events.where(events.loc[goals_idx].matchId==i).dropna()\n",
    "    for j in df['eventName']:\n",
    "        if j == 'Save attempt':saves+=1\n",
    "        else: others+=1\n",
    "    if saves!=others: print(i)\n",
    "        \n",
    "#For Match (Id = 2499781) there is one Goal event stored as (Save attempt) without attack events\n",
    "#For Match (Id = 2499988) 2 goals have been scored but there are 5 goal events stored (3 Save attempt & 2 Shot)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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iIiqqqritu98vWnTpl2+V11dXaSUig8AAMhRhwv/pqamOPnkk2PUqFGxefPm2Lx5cxx//PFx6qmnRllZWUREs7P773xdXl7eLvMCAEBn0OHCf+3atbF06dK45pprolevXtGrV6+YMmVK/PrXv4633norampqor6+vrh9fX19DB48OCorK9txagAA6Ng6XPj37ds3hg0bFnfddVds27Yttm3bFnfddVfU1NRE375942/+5m/i1ltvjVWrVsWqVavitttui4kTJ7b32AAA0KF1a+8BduXHP/5xfOELX4hBgwZFU1NTHH300TF//vyIiJg+fXr88Y9/jCOOOCIiIsaNGxc33HBDe44LAAAdXocM/49+9KPx2GOP7XJd9+7d46677oq77rprL08FAACdV4e71AcAACg94Q8AABnokJf60Ml0pl+M5nc5AACZcsYfAAAyIPwBACADwh8AADIg/AEAIAPCHwAAMiD8AQAgA8IfAAAyIPwBACADwh8AADIg/AEAIAPCHwAAMiD8AQAgA8IfAAAy0K29BwD2rkKhvSdouZTaewIA2Hc44w8AABkQ/gAAkAHhDwAAGRD+AACQAeEPAAAZEP4AAJAB4Q8AABkQ/gAAkAHhDwAAGRD+AACQgVaF/7/927/F4sWLIyJiyZIlcc4558QFF1wQr7/+epsMBwAAlEarwv/aa6+N/fffPyIirrvuuigrK4sDDjggrrzyyjYZDgAAKI1urdl41apVUVNTE42NjfH444/HsmXLokePHjFw4MC2mg8AACiBVoV/z54944033ojf/e53cfjhh0d5eXns3Lkzdu7c2VbzAQAAJdCq8B8/fnz8j//xP2L79u1x0003RUTEf/7nf8YhhxzSJsMBAACl0arw/8pXvhJjxoyJ7t27x+jRoyMionv37nH77be3xWwAAECJtCr8IyJOPvnkZs9HjhxZsmEAAIC2scfwP++886JQKOzxjX70ox+VZCAAAKD09hj+tbW1e2MOAACgDe0x/GfMmLE35gAAANpQq6/xj4hYuXJlvPnmm5FSKi4bMWJEyYYCAABKq1Xhv2DBgrjooovi5ZdfjkKhECml4vX/b731VpsMuC955xaonYFPegAA9i1dWrPxlClT4vTTT4+1a9dGRUVFrFu3LiZNmhTf/e5322o+AACgBFp9xv9nP/tZ7LfffpFSisrKyvjq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nj07Kisro6amJkaNGhUTJkxwK08AANiDVp3x/8Mf/hBnnXVWbN26NdavXx9jx46Nn//85zF37tyYO3duyYbq2rVr3H777XH77be/Z11FRUVJ/ywAAMhBq874T548OT73uc/F66+/Ht27d4+IiNGjR8eTTz7ZJsMBAACl0aoz/vX19fH4449HRBR/+LaiouJ9b6cJAAC0v1ad8e/Xr18sWbKk2bKXX345ampqSjkTAABQYq0K/yuvvDIuuOCCeOSRR+Ktt96Kn/70p3HZZZfF1Vdf3VbzAQAAJdCqS32uueaa6NatW1x//fXx1ltvxec///mYPHlyfPazn22r+QAAgBJoVfhHvP0DvpMnT26LWQAAgDbS6vB/9dVXY+7cubF8+fIYNGhQXHzxxXHIIYe0xWwAAECJtOoa/4cffjg++tGPxpNPPhlNTU3x1FNPxV/8xV/EQw891FbzAQAAJdCqM/5f+tKX4oEHHogzzzyzuOxf//Vf4wtf+EKcd955JR8OAAAojVad8V+1alV88pOfbLbstNNOizfeeKOkQwEAAKXVqvC/8MIL495772227Dvf+U5cdNFFJR0KAAAorT1e6nPeeecVf0vvzp0748orr4w77rgjhg4dGkuXLo2XX345TjvttDYfFAAA+PPtMfxra2ubPR85cmTx62OOOab0EwEAACW3x/CfMWPG3pgDAABoQ62+j/+aNWvid7/7XWzevLnZ8rPPPrtkQwEAAKXVqvD/5je/GV/4wheisrIyevXqVVxeKBSEPwAAdGCtCv+6urr4yU9+EmPGjGmreQAAgDbQqtt57rfffjF69Og2GgUAAGgrrQr/adOmxfXXXx/bt29vq3kAAIA20KrwP/744+NHP/pRlJWVRXV1dbMHAADQcbXqGv+LL744TjjhhBg7dmyzH+4FAAA6tlaF/5IlS+L555+PLl1a9UEBAADQzlpV8Keddlr85je/aatZAACANtKqM/5VVVXxyU9+Mj75yU9G//79m637+te/XtLBAACA0mlV+Dc2NsZ5550XERHr1q1rk4EAAIDSa1X433fffW01BwAA0IZaFf7Lli3b7bohQ4Z84GEAAIC20arw/9CHPhSFQiFSShERUSgUiuveeuut0k4GAACUTKvC/93X9a9YsSJuvvnmOPPMM0s6FAAAUFqtCv/Kysr3PP/2t78dH/vYx2Lc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uF/74j5F2K/OZl/cr31xnyLsV2eyL+5ThP3a13S6S33KysoiImLDhg3FZe98XV5e3i4zAQBAR9fpwr9Pnz5RU1MT9fX1xWX19fUxePDg91zmAwAAvK1rXV1dXXsP0Vrr16+POXPmxDnnnBObN2+Oz372s3HppZfGiSee2N6jtZvRo0e39whtYl/cr31xnyLsV2ezL+7XvrhPEfarM9kX9ynCfu1LOt01/hFv38f/85//fHz/+9+PiIhx48bFHXfcEd26dWvnyQAAoGPqlOEPAAC0Tqe7xh8AAGg94Q8AABkQ/gAAkAHh3wns3Lkzrr766qiuro7q6uqYMmVKNDY27nLbd+5y1L9//6iqqoq/+Zu/iYaGhr088Xu98sorcfrpp0efPn1i0KBB8dWvfnW3286bNy+OO+646NWrV9TW1r5n/fLly+Pcc8+NAw44IPr27RsXXnhhvPHGG205ftHs2bNj5MiR0aNHjzj33HObrXvppZfipJNOij59+kS/fv1iwoQJ7/t3f91118Vhhx0W5eXlcfDBB8eXv/zlZuvLysqaPbp37x4jRowo+T5t3749rrjiijj44IOjvLw8Dj/88Lj33nsjImLZsmXvmaNbt25x9tln7/b9vvzlL8chhxwSFRUV0b9//7j88stj/fr1zbaZP39+1NbWRu/evWPgwIHxrW99q+T7FRExZcqUGDx4cFRUVMSgQYPi85//fOzYsaO4/p577onDDjssevfuHR/60Ifixz/+8R7fc+vWrTFs2LCoqqpqtnz06NHRo0ePZn9XK1asKPk+tXa2jjBXKewLx8GIfeNY6DjoOOg42IklOrwbb7wxHXXUUWnFihVpxYoV6aijjko33XTTLrf9zGc+k04++eS0du3atHbt2nTKKaekK664Yi9P3FxjY2P66Ec/mm644Ya0Y8eO9Ic//CENHjw43X///bvc/mc/+1n64Q9/mGbOnJmOOuqo96w/++yz0znnnJM2bdqUNm7cmM4666w0duzYtt6NlFJKDz74YHrooYfSVVddlc4555xm60aMGJGuvPLKtH379rR69ep0zDHHpC996Uu7fa9p06al3/3ud6mxsTH9/ve/T0OHDk133333brcfPnx4uvXWW0u2L+/YvHlzmj59elq8eHFqampKv/71r1NVVVV67LHH3rPt9u3bU9++fXf7b5dSSi+//HJav359SimlDRs2pEsuuSRNmDChuP7//J//kwYNGpR++ctfpsbGxrR27dr0+9//vuT7lVJKL730Utq8eXNKKaXVq1en0aNHp1tuuSWllNLdd9+djjjiiPTb3/42NTU1pVWrVqVXXnllj+/5xS9+MZ144ompsrKy2fITTzwx/cM//EPpd6IVdjVba+a677770qc//ek2mu6D6ezHwZT2nWOh46DjoONg5yX8O4Gampr0wAMPFJ/PmzcvDRkyZJfbHnjggennP/958fm///u/p/333z81NDS0+Zy78+KLL6auXbum7du3F5fV1dWlE0888X1fd9999+3ym93w4cObHXC/973vpSOPPLJk87bEjBkz3vMNr7y8PD311FPF5zNnzkxnnHFGi9/zC1/4Qrrssst2ue7pp59OXbt2TcuXL//zBm6l8847L02fPv09y3/4wx+mPn36pK1bt7bofTZs2JDGjRuX/vqv/7q4bOTIke/7jb2trF69On3iE59I48ePT42Njalfv367/Kb+fp577rn00Y9+ND366KMd7hve7mbbV77hdfbjYEr73rHQcdBx0HGw83GpTwe3bt26eP3115t9zFtbWxvLli2LDRs2xKxZs+LMM88srmtqaor0J3dobWpqim3btsWiRYv26tx/qqmpKSLiPXMtWLAgIiImT54ckydPbvH7XXvttfHAAw/Ehg0bYv369TF37tw444wzSjv0n+GLX/xifPe7342tW7fGqlWr4qGHHmo21/vtZ0op/u///b+7/Qh7zpw5cfrpp8fAgQPbZPY/tW3btnjmmWd2OcucOXNi3Lhxsf/++xeX7Wq/vv/970dFRUVUVlbGQw89FNddd11ERGzZsiWee+652LhxYxx++OHRv3//GDt2bKxatarN9mfWrFlRXl4eBx10UDz//PMxZcqUWLhwYbzxxhuxaNGiOPjgg6OmpiYmTZoUmzZtKr7uzDPPjFmzZhWfNzY2xhVXXBF33XVX9OjRY5d/1syZM6O6ujqOPvro+O53v9tm+/Rue5qtveYqlX3hOPjOHBH79rHQcfC/OQ46DnZI7flfHezZsmXLUkSkNWvWFJetXr06RUR67bXX3rP9pz/96XTSSSelNWvWpDfffDONGTMmRUR64okn9ubYzezYsSMNGzYs/e///b/Ttm3b0gsvvJBqampS165d3/d1uzvL9fLLL6fjjjsuFQqFVCgU0rHHHps2btzYVuPv0q7OdD399NPpyCOPTF27dk0Rkc4999y0c+fOFr3f9ddfn4444ojix7F/asuWLamioiI9/PDDJZn9/TQ1NaVx48al0aNHp7feeqvZuiVLlqQuXbqk+vr6Fr/f0qVL04033phefPHFlFJKr732WoqINGLEiLRkyZK0adOmNG7cuDRmzJiS7seuvPTSS2nq1KnptddeS0888USKiDRmzJi0Zs2atGbNmnTSSSeliRMn7vb1s2bNSpdffnlKKaVf/vKX7znT9atf/SqtX78+7dixIz366KOpoqIi/ehHP2rTfWrJbK2Zq6Oe6doXjoMp7XvHQsfBlnEcdBzsSIR/B7d27doUEWnx4sXFZYsWLUoRUbx+8E+tX78+/e3f/m0aOHBgGjJkSPrHf/zHFBHppZde2ptjv8dLL72UTjnllNS3b9901FFHpenTp6eDDjrofV+zq292b731Vho6dGi67rrr0pYtW9KWLVvSddddl4499ti2HP893v0Nb+3atamioiLdcccdafv27Wnt2rVp3Lhx6eKLL97je912223pkEMO2WXApPT230P//v1b/M3zz9XU1JQmTZqURo4cucv/bc2YMSP95V/+Zavf95lnnkkf/vCHU0oprVu3LkVEuueee4rrFy9enAqFwi6/2ZfavHnz0kknnZT+3//7fyki0uOPP15c9/jjj6cDDzxwl69bvHhxGjx4cHrzzTdTSrv+hvdu11133V653rq1s717rjPOOCNVVlamysrK1LNnz9S9e/fi88rKyrR06dI234c92VeOgyntW8dCx8GWcxxsWzkcB0vFpT4dXJ8+faKmpibq6+uLy+rr62Pw4MFRWVn5nu0rKytjzpw5sXz58li6dGkMGzYs+vfvH4cddtjeHPs9jjjiiHjsscdizZo1UV9fH9u3b48TTzyx1e+zdu3aWLp0aVxzzTXRq1ev6NWrV0yZMiV+/etfx5tvvtkGk7fMK6+8Eg0NDXHNNdfEfvvtF3369IlJkybFI4888r6vmzVrVtx9993xi1/8Impqana5zT333BOf/vSno1u3bm0xekS8/RH7VVddFc8880z89Kc/fc//tpqamuK+++6LiRMntvq9d+7cGUuWLImdO3dGVVVVDBkyJAqFwi5naGs7d+6MRYsWxWGHHRb777//LufYlSeeeCLWrFkTRx55ZPTv3z/OP//82LhxY/Tv3z+eeeaZXb6mS5e9c3ht7WzvnusnP/lJrF+/PtavXx/f+MY34tJLLy0+X79+fQwZMmSv7Mf72VeOgxH79rHQcXD3HAfbVg7HwZJp3//uoCWmT5+ejj766LRy5cq0cuXKdPTRR+/2bhb/9V//lVatWpWamprSb3/723TYYYe1yw8Qvdvzzz+fNm/enLZv354efPDB1Ldv3/T888/vctvGxsa0devW9O1vfzuNGDEibd26NW3btq24ftiwYenv/u7v0tatW9PWrVvTl770pVRTU7NX9mPnzp1p69ataerUqemss85KW7duTdu3b0+bNm1Kffr0SbNnz047d+5MGzduTJdddlk6/vjjd/teX/nKV1JNTc373kHhD3/4QyoUCmnhwoVtsTtFkydPTiNGjCieLXm3Rx99NPXq1WuXZ8De7Zvf/GZ64403UkopvfLKK+mEE05IJ598cnH9O3coef3111NDQ0MaP358m3zEvWnTpnTvvfemdevWpaamprRgwYJ0xBFHFO/uMnHixOKdX9atW5dOPvnk3X7E3dDQUPz/38qVK9ODDz6YKioq0sqVK9OOHTvSunXr0r/+67+mLVu2pMbGxvT444+nqqqqNG/evJLvV2tmW716davm6sgfce8Lx8GU9o1joeOg46DjYOcl/DuBHTt2pMmTJ6eqqqpUVVWVrrrqquLHnbfeems67bTTits+9NBDadCgQalnz57pIx/5SPqnf/qn9hq7malTp6Y+ffqkXr16pWOPPTY9+eSTxXWTJk1KkyZNKj6/7777UkQ0ewwdOrS4/sUXX0ynnHJKqq6uTlVVVenjH/94+u1vf7tX9mPGjBnvme2dO3I8+eSTadSoUamysjJVV1ens846q9k3s3fvZ0Sk7t27p969excff/pvmdLbH0f+6Z0g2sKSJUtSRKQePXo0m+VPZ73wwgvT+PHjd/n6d+/Xpz71qXTggQemXr16pZqamvSZz3wmrV69uri+sbExXXvttemAAw5IBxxwQPrUpz6VVq5cWfL92rx5cxozZkyqrq5OvXv3TgcffHD64he/mLZs2VJcf/nll6fKysp00EEHpYkTJza7Pvq0007b7W0D3/0x8ju3LSwvL0/l5eVp+PDhac6cOSXfp5b409laO1dH/oa3LxwHU9o3joWOg+/lOOg42FkUUtoLnysBAADtyjX+AACQAeEPAAAZEP4AAJAB4Q8AABkQ/gAAkAHhDwAAGRD+AACQAeEPQEnddtttcckll/zZr6+trY3vfOc7pRsIgIgQ/gBExOjRo6NHjx5RVlYWffr0iRNPPDGeffbZP+u9brjhhpg7d26JJwTggxL+AERExFe+8pXYvHlzrFy5Mj72sY/Fueee2+r3aGxsbIPJACgF4Q9AM/vvv39MmDAhVqxYEX/84x/j8ccfj2OOOSaqqqriyCOPjPnz5xe3vfzyy2PChAlx0UUXRUVFRXzzm9+Murq6Zv/RsHjx4jj11FOjuro6PvzhD8cdd9zR7M+bPXt2DB48OA444ICYOnVqs3WvvvpqjBkzJiorK6O6ujpGjRoVDQ0NbfsXALCPEv4ANNPQ0BD33HNPDB06NJYvXx4XXnhhzJo1K9auXRt33313XHbZZbFw4cLi9nPnzo0JEybE+vXrY8KECc3eq7GxMc4888w46qijYsWKFfHQQw/FV7/61fj+978fERG/+MUvYurUqTFv3rxYuXJlRES88MILxddPnTo1hg0bFm+++Wa88cYb8bWvfS26deu2F/4WAPY9wh+AiIi4/vrro6qqKg455JD4wx/+EPPnz4+77747Lr/88vjEJz4RXbp0ieOPPz7OPPPMmDdvXvF1p5xySpx66qnRpUuX6NWrV7P3fPrpp2PlypUxc+bM2H///WPEiBFx9dVXF3949/77749x48bFscceG/vtt1/U1dVF7969i6/v3r17rFy5MpYsWRLdu3eP4447Lvbbb7+98vcBsK8R/gBERMSXv/zlWL9+faxatSoeffTRGDFiRCxZsiS+9a1vRVVVVfHx4x//OFasWFF83ZAhQ3b7nq+//noMHDiwWawfcsgh8frrr0dExIoVK2Lo0KHFdd27d48BAwYUn3/ta1+LQYMGxZgxY+JDH/pQ1NXVRVNTUyl3GyAbPi8FYLcGDx4cn/vc52LWrFm73aZLl92fQ6qpqYkVK1bEzp07o3v37hHx9nX7NTU1ERExcODAWLp0aXH7nTt3Fi/5iYg46KCD4hvf+EZEvH0J0JgxY2L48OFxwQUXfKD9AsiRM/4A7NakSZPivvvui1/+8pfx1ltvxfbt2+PXv/51/P73v2/R64855pjo169f3HjjjbF9+/Z44YUXYvbs2fHpT386IiIuueSSuP/+++Ppp5+OHTt2xM033xxbtmwpvn7evHmxbNmySClFZWVldO3a1TX+AH8m4Q/Abh199NExd+7cmDZtWhx44IExaNCgmD59emzfvr1Fr+/evXv85Cc/ieeeey769+8fZ599dlx77bVx6aWXRkTEmDFj4pZbbokLLrggBgwYEE1NTfEXf/EXxdc/99xzcdxxx0VZWVkce+yxMWHChDj77LPbZF8B9nWFlFJq7yEAAIC25Yw/AABkQPgDAEAGhD8AAGRA+AMAQAaEPwAAZED4AwBABoQ/AABkQPgDAEAGhD8AAGRA+AMAQAaEPwAAZOD/AzRYEhQi1fQ8AAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 900x720 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "goal_events=events.loc[goals_idx].query(\"eventName != 'Save attempt'\")\n",
    "missed_goal = events.loc[goals_idx].query(\"matchId == '2499781'\")\n",
    "goal_events = goal_events.append(missed_goal)\n",
    "\n",
    "\n",
    "queries=[]\n",
    "for j in range(1,3): #generate queries to filter goal_events for each period\n",
    "    for i in range(6):\n",
    "        if i == 5: queries.append('eventSec >'+str(i*540) + \" & matchPeriod=='\"+str(j)+\"H'\")\n",
    "        else: queries.append('eventSec >'+str(i*540) +' & eventSec <'+ str((i+1)*540)+\" & matchPeriod=='\"+str(j)+\"H'\" )\n",
    "\n",
    "\n",
    "num_goals= []\n",
    "for i in range(len(queries)): # Filtering goal_events by periods using queries\n",
    "    num_goals.append(goal_events.query(queries[i]).shape[0])\n",
    "    \n",
    "# Create bars   \n",
    "bars = ('0:9', '9:18', '18:27', '27:36', '36:45', '45+','0:9', '9:18', '18:27', '27:36', '36:45', '45+' )\n",
    "y_pos = np.arange(len(bars))\n",
    "figure(num=None, figsize=(10, 8), dpi=90, facecolor='w', edgecolor='k') # resize figure\n",
    "plt.bar(y_pos, num_goals, color=['grey', 'red', 'green', 'blue', 'cyan','orange']) \n",
    "#Label names\n",
    "plt.ylabel('Number of Goals')\n",
    "plt.xlabel('Periods')\n",
    "\n",
    "# Create names on the x-axis\n",
    "plt.xticks(y_pos, bars)\n",
    " # Show plot\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Find the top 10 teams that score the most in the interval \"81-90\"."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Team Name</th>\n",
       "      <th>Team ID</th>\n",
       "      <th># Goals</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Manchester City</td>\n",
       "      <td>1625</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arsenal</td>\n",
       "      <td>1609</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Chelsea</td>\n",
       "      <td>1610</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Manchester United</td>\n",
       "      <td>1611</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Watford</td>\n",
       "      <td>1644</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Liverpool</td>\n",
       "      <td>1612</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Crystal Palace</td>\n",
       "      <td>1628</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>West Ham United</td>\n",
       "      <td>1633</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>AFC Bournemouth</td>\n",
       "      <td>1659</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>West Bromwich Albion</td>\n",
       "      <td>1627</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Team Name  Team ID  # Goals\n",
       "0       Manchester City     1625       13\n",
       "1               Arsenal     1609       11\n",
       "2               Chelsea     1610       10\n",
       "3     Manchester United     1611        9\n",
       "4               Watford     1644        7\n",
       "5             Liverpool     1612        7\n",
       "6        Crystal Palace     1628        7\n",
       "7       West Ham United     1633        6\n",
       "8       AFC Bournemouth     1659        5\n",
       "9  West Bromwich Albion     1627        5"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from collections import Counter\n",
    "last_period = goal_events.query(\"eventSec > 2160 & eventSec < 2700 & matchPeriod== '2H'\" )\n",
    "most_freq = Counter(last_period.teamId).most_common(10)\n",
    "most_freq_id = [i[0] for i in most_freq]\n",
    "top_ten =[teams.name.where(teams.wyId == j).dropna().to_numpy()[0] for j in most_freq_id]\n",
    "result=pd.DataFrame({'Team Name':top_ten,'Team ID':most_freq_id, '# Goals':[i[1] for i in most_freq] })\n",
    "result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Show if there are players that were able to score at least one goal in 8 different intervals."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>First Name</th>\n",
       "      <th>Last Name</th>\n",
       "      <th>Id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alexandre</td>\n",
       "      <td>Lacazette</td>\n",
       "      <td>25413</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>\\u00c1lvaro Borja</td>\n",
       "      <td>Morata Mart\\u00edn</td>\n",
       "      <td>3324</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Harry</td>\n",
       "      <td>Kane</td>\n",
       "      <td>8717</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Marko</td>\n",
       "      <td>Arnautovi\\u0107</td>\n",
       "      <td>14703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Jamie</td>\n",
       "      <td>Vardy</td>\n",
       "      <td>12829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Raheem Shaquille</td>\n",
       "      <td>Sterling</td>\n",
       "      <td>11066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Mohamed</td>\n",
       "      <td>Salah Ghaly</td>\n",
       "      <td>120353</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Roberto Firmino</td>\n",
       "      <td>Barbosa de Oliveira</td>\n",
       "      <td>15808</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Romelu</td>\n",
       "      <td>Lukaku Menama</td>\n",
       "      <td>7905</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Wilfried</td>\n",
       "      <td>Zaha</td>\n",
       "      <td>8422</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Gabriel Fernando</td>\n",
       "      <td>de Jesus</td>\n",
       "      <td>340386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Riyad</td>\n",
       "      <td>Mahrez</td>\n",
       "      <td>26150</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           First Name            Last Name      Id\n",
       "0           Alexandre            Lacazette   25413\n",
       "1   \\u00c1lvaro Borja   Morata Mart\\u00edn    3324\n",
       "2               Harry                 Kane    8717\n",
       "3               Marko      Arnautovi\\u0107   14703\n",
       "4               Jamie                Vardy   12829\n",
       "5    Raheem Shaquille             Sterling   11066\n",
       "6            Mohamed           Salah Ghaly  120353\n",
       "7     Roberto Firmino  Barbosa de Oliveira   15808\n",
       "8              Romelu        Lukaku Menama    7905\n",
       "9            Wilfried                 Zaha    8422\n",
       "10   Gabriel Fernando             de Jesus  340386\n",
       "11              Riyad               Mahrez   26150"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "d={i+1:goal_events.query(queries[i])[['playerId']] for i in range(len(queries)) }\n",
    "scorer =pd.concat(d)\n",
    "players_ids=[]\n",
    "for i in scorer.playerId.unique():\n",
    "    counter=0\n",
    "    for j in range(1,len(d)+1):\n",
    "        \n",
    "        if i in scorer.loc[j].playerId.to_numpy(): \n",
    "            counter+=1\n",
    "    if counter >= 8 : \n",
    "        #print(i,counter)\n",
    "        players_ids.append(i)\n",
    "players_fnames=[players['firstName'].where(players.wyId == j).dropna().to_numpy()[0] for j in players_ids] \n",
    "players_lnames=[players['lastName'].where(players.wyId == j).dropna().to_numpy()[0] for j in players_ids]   \n",
    "result=pd.DataFrame({'First Name':players_fnames,'Last Name':players_lnames, 'Id':players_ids})\n",
    "result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
